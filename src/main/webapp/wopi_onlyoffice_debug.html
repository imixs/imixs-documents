<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head >
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />

    <title>ONLYOFFICE Document Editors</title>
    <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            -ms-content-zooming: none;
        }
        
        #office_frame {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: 0;
            border: none;
            display: block;
        }
    </style>
</head>

<body> 
	<h1>Wopi Debug</h1>
	<a href="http://localhost/hosting/discovery" target="_blank">Discovery URL</a>
	<br />
	<pre>
	wopisrc=http://imixs-documents:8080/api/wopi/e3a08859-999b-4d4d-b785-6a2bc3e4a036/files/imixs-workflow.odt
	</pre>
	<br />
	
    <form id="office_form" name="office_form" target="office_frame" action="http://localhost/hosting/wopi/word/edit?closeUrl=http://localhost:8080&wopisrc=http://imixs-documents:8080/api/wopi/e3a08859-999b-4d4d-b785-6a2bc3e4a036/files/imixs-workflow.odt" method="post">

        <input name="access_token" value="<%= token %>" type="text" />
        <input name="access_token_ttl" value="0" type="text" />
        <input type="button" onclick="test();" />
    </form>

    <span id="frameholder"></span>

    <script type="text/javascript">
    
    	function test() {
    	alert('start...');
        var frameholder = document.getElementById('frameholder');
        var office_frame = document.createElement('iframe');
        office_frame.name = 'office_frame';
        office_frame.id = 'office_frame';

        office_frame.title = 'Office Frame';
        office_frame.setAttribute('allowfullscreen', 'true');

        office_frame.setAttribute('sandbox', 'allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox allow-downloads allow-modals');
        office_frame.setAttribute('allow', 'autoplay camera microphone display-capture');
        frameholder.appendChild(office_frame);

        alert('go...');
        document.getElementById('office_form').submit();
        
    	}
    </script>
  
</body>

</html>