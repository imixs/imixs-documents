<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
	xmlns:marty="http://xmlns.jcp.org/jsf/composite/marty"
	xmlns:i="http://xmlns.jcp.org/jsf/composite/imixs">

<h:head>
	<meta name="viewport" content="width=device-width" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta content="text/javascript" http-equiv="Content-Script-Type" />
	<meta content="text/css" http-equiv="Content-Style-Type" />
	<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
	<meta name="robots" content="noindex" />
	<!-- *** CSS *** -->

	<link rel="shortcut icon" type="image/x-icon"
		href="#{facesContext.externalContext.requestContextPath}/layout/favicon.ico" />

	<!-- imixs-responsive css -->
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/imixs-basic.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/imixs-layout.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />



	<!-- imixsHeader (must be loaded before office-css! -->
	<i:imixsHeader disablecss="false"
		dateformat="#{message.datePatternShort}"
		build="#{app.application_workflow_build}"
		xtheme="#{facesContext.externalContext.requestContextPath}/layout/themes/#{app.application_theme}" />

	<!--  font icons -->
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/fonts/open_sans.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/fonts/typicons.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />

	<!-- imixs-office-workflow css -->
	<link
		href="#{facesContext.externalContext.requestContextPath}/marty/imixs-marty.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/office-theme.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />



	<!-- Chronicle Feature css -->
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/office-theme-chronicle.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />


	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/office-theme-autocomplete.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/office-theme-suggestinput.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />

	<!-- ML Feature css -->
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/office-theme-ai.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />

	<!-- custom css -->
	<link
		href="#{facesContext.externalContext.requestContextPath}/layout/css/custom.css?build=#{app.application_build_timestamp}"
		charset="UTF-8" type="text/css" rel="stylesheet" />


	
	<!-- *** SCRIPTS *** -->


	<!-- tinyMCE -->
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/tinymce/tinymce.min.js?build=#{app.application_build_timestamp}"></script>

	<!-- datepicker regional -->
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/#{message['jquey.datepicker.regional']}?build=#{app.application_build_timestamp}"></script>

	<!-- Load DataTablePlugin  -->
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/jquery.dataTables.min.js?build=#{app.application_build_timestamp}"></script>



	<!-- Imixs-Office-Workflow  -->
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/imixs-core.js?build=#{app.application_build_timestamp}"></script>

	
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/imixs-office.main.js?build=#{app.application_build_timestamp}"></script>

	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/imixs-office.main.js?build=#{app.application_build_timestamp}"></script>



	<script type="text/javascript">
		/*<![CDATA[*/
		// define script name spaces
		var imixs = IMIXS.org.imixs.core;

		// define variables for office scripts loaded from resource bundles....
		imixsOfficeMain.contextPath = "#{facesContext.externalContext.requestContextPath}";
		imixsOfficeMain.error_message_mce_image_size = "#{message.error_message_mce_image_size}";
		imixsOfficeMain.imixs_date_showWeek = ("true" === "#{app['jquey.datepicker.showWeek']}");
		/*]]>*/
	</script>



		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/js/imixs-office.workitem.js?build=#{app.application_build_timestamp}"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/js/imixs-office.workitem.custom.js?build=#{app.application_build_timestamp}"></script>

		<!-- Imixs-Adapter-Wopi integration -->
		<ui:fragment rendered="#{wopiController!=null and wopiController.enabled}">
			<link href="#{facesContext.externalContext.requestContextPath}/layout/css/office-theme-wopi.css?build=#{app.application_build_timestamp}"
				type="text/css" rel="stylesheet" />
			<script type="text/javascript"
				src="#{facesContext.externalContext.requestContextPath}/js/imixs-wopi.js?build=#{app.application_build_timestamp}"></script>
			<script type="text/javascript"
				src="#{facesContext.externalContext.requestContextPath}/js/imixs-office.workitem.wopi.js?build=#{app.application_build_timestamp}"></script>
		</ui:fragment>

		<script type="text/javascript">
			/*<![CDATA[*/
		
			

			/*]]>*/
		</script>

</h:head>

	
<h:body>
	<f:view locale="#{userController.locale}">

		<!-- SystemSetupStatus=#{initController.initStatus} -->
		<h3>Wopi Debug Page</h3>
		<!-- Imixs-Adapter-Wopi integration -->

		<script type="text/javascript">
			/*<![CDATA[*/
			imixsOfficeWorkitem.registerSaveWorkitemListener(workitemSaveCallback);
			dialogActionConfirm = "#{message.wopi_ok}";
			dialogActionCancel = "#{message.wopi_cancel}";
			/*]]>*/
		</script>
		<div style="display: normal;" class="imixs-form" id="wopi_controlls">
			<h1 id="wopi_header_filename_id"></h1>
			<div class="wopi-action-bar">
				<input type="button" onclick="imixsWopi.save(); return false;"
					style="display: none;" class="imixs-workflow-action"
					value="#{message.update}" /><input type="button"
					onclick="closeWopiViewer('#{message.discard_changes}'); return false;"
					class="imixs-workflow-action" value="#{message.close}" /><input
					type="button"
					onclick="imixsWopi.switchToFullScreen(); return false;"
					class="imixs-workflow-action" value="#{message.fullscreen}" />
			</div>
		</div>
		<div id="wopi_canvas" style="display: none;"></div>
		<!-- confirm close alert -->
		<div id="wopi-save-dialog" title="#{message.wopi_confirm_title}">
			message.wopi_confirm_message</div>
	
	
		<hr />
		  <script>
		     testWopi=function () {
		    	 alert('get los');
		       const _uri=$('#wopi_uri_input').val();
		       const _filename=$('#file_name').val();
		       openWopiViewer(_uri,_filename,'message.discard_changes');
		     }
		  
		  </script>
		
		  <form>
		        <input name="wopi_uri" id="wopi_uri_input" value=" wopi uri " type="text" />
		        <input name="file_name" value=" file name " type="text" />
		        <a  href="#"  onclick="testWopi();" class="wopi-editor-link" data-wopi-openonload="#{false}" ><span class="typcn typcn-pencil"></span> load</a>
		  </form>
		



	</f:view>
</h:body>
</html>